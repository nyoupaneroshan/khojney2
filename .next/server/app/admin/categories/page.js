(()=>{var e={};e.id=631,e.ids=[631],e.modules={1241:()=>{},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9699:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(41253);let n=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},13742:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(84667).A)("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]])},14276:()=>{},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20476:(e,t,s)=>{Promise.resolve().then(s.bind(s,40057))},20685:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,metadata:()=>l});var r=s(38828),n=s(22282),a=s.n(n);s(14276);var i=s(59229);let l={title:"Khojney App",description:"Your awesome quiz application"};function o({children:e}){return(0,r.jsx)("html",{lang:"en",className:"dark",children:(0,r.jsx)("body",{className:a().className,children:(0,r.jsx)(i.AuthProvider,{children:e})})})}},21503:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>d});var r=s(13486),n=s(60159),a=s(98510),i=s(60532);let l="user_role",o=(0,n.createContext)(void 0),c=()=>{let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},d=({children:e})=>{let[t,s]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=async e=>{if(s(e),e?.user){let{data:t,error:s}=await a.N.from("profiles").select("role").eq("id",e.user.id).single();if(s)console.error("Error fetching user role:",s.message),d(null),i.A.remove(l);else if(t){d(t.role);let s=e.expires_in,r=s?new Date(Date.now()+1e3*s):void 0;i.A.set(l,t.role,{expires:r})}else console.warn("User profile not found for ID:",e.user.id),d(null),i.A.remove(l)}else d(null),i.A.remove(l);m(!1)};a.N.auth.getSession().then(({data:{session:t}})=>{e(t)});let{data:{subscription:t}}=a.N.auth.onAuthStateChange((t,s)=>{e(s)});return()=>t.unsubscribe()},[]),(0,r.jsx)(o.Provider,{value:{session:t,loadingAuth:u,userRole:c},children:e})}},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30204:(e,t,s)=>{Promise.resolve().then(s.bind(s,82764))},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},40057:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/admin/categories/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/admin/categories/page.tsx","default")},43967:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(84667).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},54871:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,69355,23)),Promise.resolve().then(s.t.bind(s,54439,23)),Promise.resolve().then(s.t.bind(s,67851,23)),Promise.resolve().then(s.t.bind(s,94730,23)),Promise.resolve().then(s.t.bind(s,19774,23)),Promise.resolve().then(s.t.bind(s,53170,23)),Promise.resolve().then(s.t.bind(s,20968,23)),Promise.resolve().then(s.t.bind(s,78298,23))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57510:(e,t,s)=>{Promise.resolve().then(s.bind(s,21503))},59229:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>n});var r=s(33952);(0,r.registerClientReference)(function(){throw Error("Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/components/AuthContext.tsx","useAuth");let n=(0,r.registerClientReference)(function(){throw Error("Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/components/AuthContext.tsx","AuthProvider")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63382:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var r=s(24332),n=s(48819),a=s(67851),i=s.n(a),l=s(97540),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c={children:["",{children:["admin",{children:["categories",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,40057)),"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/admin/categories/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,20685)),"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,92341,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/admin/categories/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/admin/categories/page",pathname:"/admin/categories",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},66543:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,30385,23)),Promise.resolve().then(s.t.bind(s,33737,23)),Promise.resolve().then(s.t.bind(s,86081,23)),Promise.resolve().then(s.t.bind(s,1904,23)),Promise.resolve().then(s.t.bind(s,35856,23)),Promise.resolve().then(s.t.bind(s,55492,23)),Promise.resolve().then(s.t.bind(s,89082,23)),Promise.resolve().then(s.t.bind(s,45812,23))},68689:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(84667).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},72088:()=>{},74075:e=>{"use strict";e.exports=require("zlib")},76029:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=76029,e.exports=t},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},82764:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>D});var r=s(13486),n=s(60159),a=s(49989),i=s.n(a),l=s(98510),o=s(4653),c=s(54528),d=s(97430),u=s(79438),m=s(92816),h=s(72513),x=s(5447),p=s(68689),g=s(43967),b=s(77026),y=s(15998),f=s(74439),j=s(13742),v=s(23982),N=s(35795),w=s(68574),_=s(1039);let k=(0,s(84667).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var C=s(86e3),A=s(15577);let P=({checked:e,onChange:t})=>(0,r.jsx)("button",{type:"button",onClick:()=>t(!e),className:`${e?"bg-cyan-600":"bg-gray-600"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-gray-900`,role:"switch","aria-checked":e,children:(0,r.jsx)("span",{"aria-hidden":"true",className:`${e?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})});function S({category:e,onSave:t,onCancel:s,allCategories:a=[]}){let[i,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[p,g]=(0,n.useState)(""),[b,y]=(0,n.useState)(!1),[f,j]=(0,n.useState)(null),[v,N]=(0,n.useState)(!1),[w,S]=(0,n.useState)(null),z=async s=>{s.preventDefault(),N(!0),S(null);let r={name_en:i,name_ne:c,slug:u,description_en:h,description_ne:p,is_published:b,parent_category_id:""===f?null:f,updated_at:new Date().toISOString()},{data:n,error:a}=e?.id?await l.N.from("categories").update(r).eq("id",e.id).select().single():await l.N.from("categories").insert(r).select().single();a?S(a.message):n&&t(n),N(!1)},q=a.filter(t=>t.id!==e?.id);return(0,r.jsxs)("div",{className:"flex flex-col h-full bg-gray-900 text-white",children:[(0,r.jsxs)("header",{className:"flex-shrink-0 flex justify-between items-center p-6 border-b border-gray-700",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold",children:[e?"Edit":"Create New"," Category"]}),(0,r.jsx)("button",{onClick:s,className:"p-2 text-gray-500 hover:text-white rounded-full hover:bg-gray-800 transition-colors",children:(0,r.jsx)(_.A,{size:24})})]}),(0,r.jsxs)("form",{onSubmit:z,className:"flex-grow p-6 space-y-8 overflow-y-auto",children:[(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-cyan-400 border-b border-cyan-400/20 pb-2",children:"Basic Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name_en",className:"block text-sm font-medium text-gray-300",children:"English Name"}),(0,r.jsx)("input",{id:"name_en",type:"text",value:i,onChange:e=>o(e.target.value),className:"w-full mt-1 input-base",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name_ne",className:"block text-sm font-medium text-gray-300",children:"Nepali Name"}),(0,r.jsx)("input",{id:"name_ne",type:"text",value:c,onChange:e=>d(e.target.value),className:"w-full mt-1 input-base"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-300",children:"Slug"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)("input",{id:"slug",type:"text",value:u,onChange:e=>m(e.target.value),className:"w-full input-base",required:!0}),(0,r.jsx)("button",{type:"button",onClick:()=>{m(i.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""))},title:"Generate slug from English name",className:"p-2 bg-gray-700 hover:bg-gray-600 rounded-md transition-colors",children:(0,r.jsx)(k,{size:18})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"parent_category",className:"block text-sm font-medium text-gray-300",children:"Parent Category"}),(0,r.jsxs)("select",{id:"parent_category",value:f||"",onChange:e=>j(e.target.value||null),className:"w-full mt-1 input-base",children:[(0,r.jsx)("option",{value:"",children:"-- No Parent (Top Level) --"}),q.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name_en},e.id))]})]})]}),(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-cyan-400 border-b border-cyan-400/20 pb-2",children:"Content"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description_en",className:"block text-sm font-medium text-gray-300",children:"English Description"}),(0,r.jsx)("textarea",{id:"description_en",value:h,onChange:e=>x(e.target.value),rows:3,className:"w-full mt-1 input-base"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description_ne",className:"block text-sm font-medium text-gray-300",children:"Nepali Description"}),(0,r.jsx)("textarea",{id:"description_ne",value:p,rows:3,onChange:e=>g(e.target.value),className:"w-full mt-1 input-base"})]})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-cyan-400 border-b border-cyan-400/20 pb-2",children:"Settings"}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-4 p-3 bg-gray-800/50 rounded-lg",children:[(0,r.jsx)("label",{htmlFor:"is_published",className:"font-medium text-gray-200",children:"Publish Category"}),(0,r.jsx)(P,{checked:b,onChange:y})]})]})]}),(0,r.jsxs)("footer",{className:"flex-shrink-0 p-6 border-t border-gray-700 bg-gray-900 flex justify-between items-center",children:[w&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,r.jsx)(C.A,{size:18}),(0,r.jsx)("span",{children:w})]}),(0,r.jsx)("div",{className:"flex-grow"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{type:"button",onClick:s,className:"px-5 py-2 font-bold text-gray-300 bg-gray-700/50 rounded-md hover:bg-gray-700 transition-colors",children:"Cancel"}),(0,r.jsxs)("button",{type:"button",onClick:()=>document.querySelector("form")?.requestSubmit(),className:"px-5 py-2 font-bold text-white bg-cyan-600 rounded-md hover:bg-cyan-500 disabled:bg-gray-500 flex items-center gap-2",disabled:v,children:[v&&(0,r.jsx)(A.A,{size:16,className:"animate-spin"}),v?"Saving...":"Save Category"]})]})]})]})}var z=s(97334);let q=({icon:e,title:t,value:s,colorClass:n})=>(0,r.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/80 rounded-xl p-5",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:`flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center ${n}`,children:e}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-slate-400",children:t}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:s})]})]})}),M=({allCategories:e,onUploadComplete:t})=>{let[s,a]=(0,n.useState)(null),[i,o]=(0,n.useState)(!1),[c,p]=(0,n.useState)(null),g=e=>{let t=e.split("\n").filter(e=>""!==e.trim());if(t.length<2)return[];let s=t[0].split(",").map(e=>e.trim());return t.slice(1).map(e=>{let t=e.split(",").map(e=>e.trim().replace(/"/g,"")),r={};return s.forEach((e,s)=>r[e]=t[s]),{name_en:r.name_en,slug:r.slug,name_ne:r.name_ne,description_en:r.description_en,description_ne:r.description_ne,parent_category_name:r.parent_category_name,is_published:!r.is_published||"true"===r.is_published.toLowerCase()}})},b=async()=>{if(!s)return;o(!0),p(null);let r=new FileReader;r.onload=async s=>{try{let r=s.target?.result;if("string"!=typeof r)throw Error("Could not read file content.");let n=g(r),a=new Map(e.map(e=>[e.name_en.toLowerCase(),e.id])),i=0;for(let e of n){let t=null;if(e.parent_category_name&&!(t=a.get(e.parent_category_name.toLowerCase())||null))throw Error(`Parent category "${e.parent_category_name}" not found for child "${e.name_en}". Please ensure parents exist or are listed before children in the CSV.`);let{data:s,error:r}=await l.N.from("categories").insert({name_en:e.name_en,slug:e.slug,name_ne:e.name_ne,description_en:e.description_en,description_ne:e.description_ne,parent_category_id:t,is_published:e.is_published??!0}).select("id, name_en").single();if(r)throw Error(`Error adding category "${e.name_en}": ${r.message}`);a.set(s.name_en.toLowerCase(),s.id),i++}p({type:"success",message:`Successfully added ${i} categories!`}),t()}catch(e){p({type:"error",message:e.message||"An unknown error occurred."})}finally{o(!1),a(null)}},r.readAsText(s)};return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 my-12",children:[(0,r.jsxs)("div",{className:"bg-slate-800/50 p-6 rounded-xl border border-slate-700",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)(d.A,{className:"h-6 w-6 text-cyan-400"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-white",children:"Bulk Import Categories"})]}),(0,r.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Upload a CSV file to add multiple categories at once."}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("label",{htmlFor:"file-upload",className:"cursor-pointer bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg hover:bg-slate-600 transition-colors",children:s?"File Selected":"Choose File"}),(0,r.jsx)("input",{id:"file-upload",type:"file",className:"hidden",accept:".csv",onChange:e=>{e.target.files&&(a(e.target.files[0]),p(null))}}),(0,r.jsx)("span",{className:"text-slate-500 text-sm truncate",children:s?.name||"No file chosen"})]}),(0,r.jsx)("button",{onClick:b,disabled:!s||i,className:"w-full mt-4 py-2.5 px-4 rounded-lg bg-cyan-600 text-white font-bold hover:bg-cyan-500 disabled:bg-slate-600 disabled:cursor-not-allowed transition-colors",children:i?"Uploading...":"Upload Categories"}),c&&(0,r.jsxs)("div",{className:`mt-4 p-3 rounded-md text-sm flex items-center gap-2 ${"success"===c.type?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"}`,children:["success"===c.type?(0,r.jsx)(u.A,{size:16}):(0,r.jsx)(m.A,{size:16}),c.message]})]}),(0,r.jsxs)("div",{className:"bg-slate-800/50 p-6 rounded-xl border border-slate-700",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(h.A,{className:"h-6 w-6 text-slate-400"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-white",children:"CSV Data Format"})]}),(0,r.jsxs)("button",{onClick:()=>{let e=encodeURI(`data:text/csv;charset=utf-8,name_en,slug,name_ne,description_en,description_ne,parent_category_name,is_published
"Physics","physics","भौतिक विज्ञान","Questions related to classical and modern physics.","","","true"
"Quantum Mechanics","quantum-mechanics","क्वान्टम मेकानिक्स","The study of matter and light on the atomic and subatomic scale.","","Physics","true"`),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","sample_categories.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"flex items-center gap-2 text-sm bg-slate-700 text-white font-semibold py-2 px-3 rounded-lg hover:bg-slate-600 transition-colors",children:[(0,r.jsx)(x.A,{size:16})," Download Sample"]})]}),(0,r.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"File must have exact headers. `parent_category_name` must match an existing `name_en`."}),(0,r.jsx)("pre",{className:"bg-black/50 p-4 rounded-md text-xs text-slate-300 overflow-x-auto",children:(0,r.jsx)("code",{children:"name_en, slug, name_ne, description_en, parent_category_name, ..."})})]})]})},E=({category:e,level:t,allCategories:s,handleEdit:a,searchTerm:i,statusFilter:l})=>{let[o,c]=(0,n.useState)(!1),d=(0,n.useMemo)(()=>s.filter(t=>t.parent_category_id===e.id).sort((e,t)=>e.name_en.localeCompare(t.name_en)),[s,e.id]),u=(0,n.useCallback)(e=>{let t=e.name_en.toLowerCase().includes(i.toLowerCase()),s="all"===l||("published"===l?e.is_published:!e.is_published);return t&&s},[i,l]);return(0,n.useMemo)(()=>{if(u(e))return!0;let t=e=>{for(let r of e)if(u(r)||t(s.filter(e=>e.parent_category_id===r.id)))return!0;return!1};return t(d)},[e,d,u,s])?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("tr",{className:"border-t border-slate-700/50 hover:bg-slate-700/50",children:[(0,r.jsx)("td",{className:"p-4 font-semibold",style:{paddingLeft:`${16+20*t}px`},children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[d.length>0?(0,r.jsx)("button",{onClick:()=>c(!o),className:"text-slate-400 hover:text-white mr-1",children:o?(0,r.jsx)(p.A,{size:16}):(0,r.jsx)(g.A,{size:16})}):(0,r.jsx)("div",{style:{width:"20px"}}),e.name_en]})}),(0,r.jsx)("td",{className:"p-4 text-slate-400 font-mono hidden sm:table-cell",children:e.slug}),(0,r.jsx)("td",{className:"p-4",children:(0,r.jsx)("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e.is_published?"bg-green-500/20 text-green-300":"bg-yellow-500/20 text-yellow-300"}`,children:e.is_published?"Published":"Draft"})}),(0,r.jsx)("td",{className:"p-4 text-slate-400 hidden md:table-cell",children:new Date(e.created_at).toLocaleDateString()}),(0,r.jsx)("td",{className:"p-4 text-right",children:(0,r.jsxs)("button",{onClick:()=>a(e),className:"text-cyan-400 hover:text-cyan-300 inline-flex items-center gap-1",children:[(0,r.jsx)(b.A,{size:14})," Edit"]})})]}),o&&d.map(e=>(0,r.jsx)(E,{category:e,level:t+1,allCategories:s,handleEdit:a,searchTerm:i,statusFilter:l},e.id))]}):null};function D(){let[e,t]=(0,n.useState)(!0),[s,a]=(0,n.useState)(!1),[d,m]=(0,n.useState)([]),[h,x]=(0,n.useState)(!1),[p,g]=(0,n.useState)(null),[b,_]=(0,n.useState)(""),[k,C]=(0,n.useState)("all"),[A,P]=(0,n.useState)({key:"created_at",direction:"desc"}),[D,I]=(0,n.useState)(1),F=(0,n.useCallback)(async()=>{try{let{data:e,error:t}=await l.N.from("categories").select("*").order("created_at",{ascending:!1});if(t)throw t;m(e||[])}catch(e){console.error("Error fetching categories:",e)}},[]),L=e=>{g(e),x(!0)},U=(0,n.useMemo)(()=>{let e=d.filter(e=>e.is_published).length;return{total:d.length,published:e,drafts:d.length-e}},[d]),T=(0,n.useMemo)(()=>d.filter(e=>null===e.parent_category_id).sort((e,t)=>{let s=e[A.key]??"",r=t[A.key]??"";return s<r?"asc"===A.direction?-1:1:s>r?"asc"===A.direction?1:-1:0}),[d,A]),G=(0,n.useMemo)(()=>{let e=(D-1)*10;return T.slice(e,e+10)},[T,D]),O=Math.ceil(T.length/10),Q=e=>{let t=A.key===e&&"asc"===A.direction?"desc":"asc";P({key:e,direction:t}),I(1)};return e?(0,r.jsx)(z.e,{}):s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.N,{children:h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.P.div,{className:"fixed inset-0 bg-black/60 z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),(0,r.jsx)(c.P.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 right-0 h-full w-full max-w-lg bg-gray-900 shadow-2xl z-50 border-l border-gray-800",children:(0,r.jsx)(S,{category:p,onSave:()=>{x(!1),g(null),F()},onCancel:()=>{x(!1),g(null)},allCategories:d})},p?p.id:"create-new-category")]})}),(0,r.jsx)("main",{className:"w-full p-8 sm:p-12 bg-gray-900 text-white min-h-screen",children:(0,r.jsxs)("div",{className:"mx-auto max-w-7xl",children:[(0,r.jsx)("div",{className:"mb-10",children:(0,r.jsxs)(i(),{href:"/admin",className:"inline-flex items-center gap-2 text-sm text-cyan-400 hover:text-cyan-300",children:[(0,r.jsx)(y.A,{size:16})," Back to Admin Dashboard"]})}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold",children:"Category Management"}),(0,r.jsxs)("button",{onClick:()=>{g(null),x(!0)},className:"inline-flex items-center justify-center gap-2 bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 px-5 rounded-lg transition-colors",children:[(0,r.jsx)(f.A,{size:18})," New Category"]})]}),(0,r.jsxs)(c.P.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,r.jsx)(q,{icon:(0,r.jsx)(j.A,{size:22}),title:"Total Categories",value:U.total,colorClass:"bg-purple-500/20 text-purple-300"}),(0,r.jsx)(q,{icon:(0,r.jsx)(u.A,{size:22}),title:"Published",value:U.published,colorClass:"bg-green-500/20 text-green-300"}),(0,r.jsx)(q,{icon:(0,r.jsx)(v.A,{size:22}),title:"Drafts",value:U.drafts,colorClass:"bg-yellow-500/20 text-yellow-300"})]}),(0,r.jsx)(M,{allCategories:d,onUploadComplete:F}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"relative flex-grow",children:[(0,r.jsx)(N.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:18}),(0,r.jsx)("input",{type:"text",placeholder:"Search categories...",value:b,onChange:e=>{_(e.target.value),I(1)},className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2 pl-10 pr-4 text-white focus:outline-none focus:ring-1 focus:ring-cyan-500"})]}),(0,r.jsxs)("select",{value:k,onChange:e=>{C(e.target.value),I(1)},className:"bg-gray-800 border border-gray-700 rounded-lg py-2 px-3 text-white focus:outline-none focus:ring-1 focus:ring-cyan-500",children:[(0,r.jsx)("option",{value:"all",children:"All Statuses"}),(0,r.jsx)("option",{value:"published",children:"Published"}),(0,r.jsx)("option",{value:"draft",children:"Draft"})]})]}),(0,r.jsx)("div",{className:"bg-gray-800/60 border border-gray-700/60 rounded-xl shadow-lg overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-left",children:[(0,r.jsx)("thead",{className:"bg-gray-900/50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-4 cursor-pointer hover:bg-gray-700/50 transition-colors",onClick:()=>Q("name_en"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["Name ",(0,r.jsx)(w.A,{size:14})]})}),(0,r.jsx)("th",{className:"p-4 cursor-pointer hover:bg-gray-700/50 transition-colors hidden sm:table-cell",onClick:()=>Q("slug"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["Slug ",(0,r.jsx)(w.A,{size:14})]})}),(0,r.jsx)("th",{className:"p-4 cursor-pointer hover:bg-gray-700/50 transition-colors",onClick:()=>Q("is_published"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["Status ",(0,r.jsx)(w.A,{size:14})]})}),(0,r.jsx)("th",{className:"p-4 cursor-pointer hover:bg-gray-700/50 transition-colors hidden md:table-cell",onClick:()=>Q("created_at"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["Created ",(0,r.jsx)(w.A,{size:14})]})}),(0,r.jsx)("th",{className:"p-4 text-right",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:G.length>0?G.map(e=>(0,r.jsx)(E,{category:e,level:0,allCategories:d,handleEdit:L,searchTerm:b,statusFilter:k},e.id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"text-center text-gray-500 py-16",children:"No categories found matching your criteria."})})})]})})}),O>1&&(0,r.jsxs)("div",{className:"flex items-center justify-between mt-6 text-sm",children:[(0,r.jsx)("button",{onClick:()=>I(e=>Math.max(1,e-1)),disabled:1===D,className:"flex items-center gap-2 px-4 py-2 bg-gray-700/80 rounded-md disabled:opacity-50 hover:bg-gray-700/100 transition-colors",children:"Previous"}),(0,r.jsxs)("span",{className:"font-semibold text-gray-300",children:["Page ",D," of ",O]}),(0,r.jsx)("button",{onClick:()=>I(e=>Math.min(O,e+1)),disabled:D===O,className:"flex items-center gap-2 px-4 py-2 bg-gray-700/80 rounded-md disabled:opacity-50 hover:bg-gray-700/100 transition-colors",children:"Next"})]})]})})]}):(0,r.jsx)(z.O,{})}},89054:(e,t,s)=>{Promise.resolve().then(s.bind(s,59229))},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},97334:(e,t,s)=>{"use strict";s.d(t,{O:()=>l,e:()=>i});var r=s(13486),n=s(49989),a=s.n(n);let i=()=>(0,r.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center p-24",children:(0,r.jsx)("p",{children:"Loading admin section..."})}),l=()=>(0,r.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-center p-24",children:[(0,r.jsx)("h1",{className:"text-2xl text-red-500",children:"Access Denied"}),(0,r.jsx)("p",{className:"mt-4",children:"You must be an admin to view this page."}),(0,r.jsx)(a(),{href:"/",className:"text-blue-400 hover:text-blue-300 mt-6",children:"Go to Homepage"})]})},98510:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(95681).createBrowserClient)("https://uxpdqthqyttujyvqwaeh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV4cGRxdGhxeXR0dWp5dnF3YWVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5NzE3MzgsImV4cCI6MjA2NDU0NzczOH0.clopYxo2qaXYmw4poLnEoJOe6hXXotZwR3GYZL_GdMQ")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[50,199,253,154,989,815],()=>s(63382));module.exports=r})();