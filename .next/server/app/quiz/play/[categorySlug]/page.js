(()=>{var e={};e.id=439,e.ids=[439],e.modules={1039:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(84667).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},2984:(e,t,r)=>{"use strict";var s=r(860);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4653:(e,t,r)=>{"use strict";r.d(t,{N:()=>g});var s=r(13486),n=r(60159),i=r(59734),a=r(11650),o=r(46257),l=r(95834),u=r(80880),c=r(267);class d extends n.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,u.s)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function p({children:e,isPresent:t,anchorX:r}){let i=(0,n.useId)(),a=(0,n.useRef)(null),o=(0,n.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=(0,n.useContext)(c.Q);return(0,n.useInsertionEffect)(()=>{let{width:e,height:s,top:n,left:u,right:c}=o.current;if(t||!a.current||!e||!s)return;let d="left"===r?`left: ${u}`:`right: ${c}`;a.current.dataset.motionPopId=i;let p=document.createElement("style");return l&&(p.nonce=l),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${s}px !important;
            ${d}px !important;
            top: ${n}px !important;
          }
        `),()=>{document.head.contains(p)&&document.head.removeChild(p)}},[t]),(0,s.jsx)(d,{isPresent:t,childRef:a,sizeRef:o,children:n.cloneElement(e,{ref:a})})}let h=({children:e,initial:t,isPresent:r,onExitComplete:i,custom:o,presenceAffectsLayout:u,mode:c,anchorX:d})=>{let h=(0,a.M)(m),f=(0,n.useId)(),x=!0,y=(0,n.useMemo)(()=>(x=!1,{id:f,initial:t,isPresent:r,custom:o,onExitComplete:e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;i&&i()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[r,h,i]);return u&&x&&(y={...y}),(0,n.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[r]),n.useEffect(()=>{r||h.size||!i||i()},[r]),"popLayout"===c&&(e=(0,s.jsx)(p,{isPresent:r,anchorX:d,children:e})),(0,s.jsx)(l.t.Provider,{value:y,children:e})};function m(){return new Map}var f=r(50945);let x=e=>e.key||"";function y(e){let t=[];return n.Children.forEach(e,e=>{(0,n.isValidElement)(e)&&t.push(e)}),t}let g=({children:e,custom:t,initial:r=!0,onExitComplete:l,presenceAffectsLayout:u=!0,mode:c="sync",propagate:d=!1,anchorX:p="left"})=>{let[m,g]=(0,f.xQ)(d),j=(0,n.useMemo)(()=>y(e),[e]),b=d&&!m?[]:j.map(x),w=(0,n.useRef)(!0),k=(0,n.useRef)(j),v=(0,a.M)(()=>new Map),[_,q]=(0,n.useState)(j),[N,P]=(0,n.useState)(j);(0,o.E)(()=>{w.current=!1,k.current=j;for(let e=0;e<N.length;e++){let t=x(N[e]);b.includes(t)?v.delete(t):!0!==v.get(t)&&v.set(t,!1)}},[N,b.length,b.join("-")]);let z=[];if(j!==_){let e=[...j];for(let t=0;t<N.length;t++){let r=N[t],s=x(r);b.includes(s)||(e.splice(t,0,r),z.push(r))}return"wait"===c&&z.length&&(e=z),P(y(e)),q(j),null}let{forceRender:M}=(0,n.useContext)(i.L);return(0,s.jsx)(s.Fragment,{children:N.map(e=>{let n=x(e),i=(!d||!!m)&&(j===N||b.includes(n));return(0,s.jsx)(h,{isPresent:i,initial:(!w.current||!!r)&&void 0,custom:t,presenceAffectsLayout:u,mode:c,onExitComplete:i?void 0:()=>{if(!v.has(n))return;v.set(n,!0);let e=!0;v.forEach(t=>{t||(e=!1)}),e&&(M?.(),P(k.current),d&&g?.(),l&&l())},anchorX:p,children:e},n)})})}},8782:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>d,pages:()=>c,routeModule:()=>p,tree:()=>u});var s=r(24332),n=r(48819),i=r(67851),a=r.n(i),o=r(97540),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let u={children:["",{children:["quiz",{children:["play",{children:["[categorySlug]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9665)),"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/quiz/play/[categorySlug]/page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,20685)),"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,92341,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/quiz/play/[categorySlug]/page.tsx"],d={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/quiz/play/[categorySlug]/page",pathname:"/quiz/play/[categorySlug]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},9665:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(38828),n=r(85296),i=r(65208),a=r(42543),o=r(11086);async function l({params:e,searchParams:t}){let r=(0,i.UL)(),l=(0,n.createServerClient)("https://uxpdqthqyttujyvqwaeh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV4cGRxdGhxeXR0dWp5dnF3YWVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5NzE3MzgsImV4cCI6MjA2NDU0NzczOH0.clopYxo2qaXYmw4poLnEoJOe6hXXotZwR3GYZL_GdMQ",{cookies:{get:e=>r.get(e)?.value}}),{data:{session:u}}=await l.auth.getSession();u||(0,a.redirect)("/");let[c,d]=await Promise.all([l.from("categories").select(`
        id, name_en, slug,
        questions (
          id, question_text_en, difficulty_level, question_type,
          options ( id, question_id, option_text_en, is_correct )
        )
      `).eq("slug",e.categorySlug).eq("is_published",!0).single(),l.from("quiz_modes").select("*").eq("is_active",!0)]);(c.error||!c.data)&&(0,a.notFound)();let p=t.difficulty||"all",h=Number(t.limit)||10,m=c.data.questions;"all"!==p&&(m=m.filter(e=>e.difficulty_level===p));let f=m.slice(0,h);return(0,s.jsx)(o.default,{category:c.data,initialQuestions:f,user:u.user,quizModes:d.data||[]})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11086:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/quiz/play/[categorySlug]/quiz-play-client.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/nyoupane/Documents/11TechMedia/QuizApp/khojney/khojney_main/khojney-app/new_khojney/khojney-main/src/app/quiz/play/[categorySlug]/quiz-play-client.tsx","default")},11997:e=>{"use strict";e.exports=require("punycode")},15577:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(84667).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},18880:(e,t,r)=>{"use strict";r.d(t,{default:()=>y});var s=r(13486),n=r(60159),i=r(2984),a=r(98510),o=r(49391),l=r(1039),u=r(15577),c=r(77816),d=r(54528),p=r(4653);let h=({current:e,total:t})=>(0,s.jsx)("div",{className:"w-full bg-slate-700/50 rounded-full h-2",children:(0,s.jsx)(d.P.div,{className:"bg-cyan-400 h-2 rounded-full",initial:{width:"0%"},animate:{width:`${t>0?(e+1)/t*100:0}%`},transition:{duration:.5,ease:"easeInOut"}})}),m=({timeLeft:e,totalTime:t})=>{let r=2*Math.PI*20,n=r*(1-e/t),i=e<=5?"text-red-400":"text-cyan-300";return(0,s.jsxs)("div",{className:"relative h-20 w-20",children:[(0,s.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 44 44",transform:"rotate(-90 22 22)",children:[(0,s.jsx)("circle",{className:"text-slate-700",strokeWidth:"4",stroke:"currentColor",fill:"transparent",r:"20",cx:"22",cy:"22"}),(0,s.jsx)(d.P.circle,{className:e<=5?"text-red-500":"text-cyan-400",strokeWidth:"4",strokeDasharray:r,strokeDashoffset:r,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"20",cx:"22",cy:"22",animate:{strokeDashoffset:n},transition:{duration:1,ease:"linear"}})]}),(0,s.jsx)("div",{className:`absolute inset-0 flex items-center justify-center font-mono text-2xl font-bold ${i}`,children:e})]})},f=({option:e,state:t,onClick:r,index:n})=>{let i={correct:(0,s.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,s.jsx)(o.A,{className:"h-5 w-5 text-white"})}),incorrect:(0,s.jsx)("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:(0,s.jsx)(l.A,{className:"h-5 w-5 text-white"})}),default:(0,s.jsx)("div",{className:"w-6 h-6 border-2 border-slate-500 rounded-full flex items-center justify-center text-cyan-400 font-bold text-sm",children:n+1})};return(0,s.jsx)(d.P.li,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*n},children:(0,s.jsxs)("button",{onClick:r,disabled:"default"!==t,className:`w-full text-left p-4 rounded-lg border-2 transition-all duration-200 flex items-center gap-4 text-lg backdrop-blur-sm ${{default:"bg-slate-800/50 border-slate-700 hover:border-cyan-500/70 hover:bg-slate-700/50 text-slate-200",correct:"bg-green-500/20 border-green-500 text-white font-semibold ring-2 ring-green-500/50",incorrect:"bg-red-500/20 border-red-500 text-white font-semibold"}[t]}`,children:[i[t],(0,s.jsx)("span",{children:e.option_text_en})]})})},x=e=>{let t=e.length,r;for(;0!==t;)r=Math.floor(Math.random()*t),t--,[e[t],e[r]]=[e[r],e[t]];return e};function y({category:e,initialQuestions:t,user:r,quizModes:o}){let l=(0,i.useRouter)(),y=(0,i.useSearchParams)();(0,n.useRef)(!1);let[g,j]=(0,n.useState)(!1),[b,w]=(0,n.useState)(null),[k,v]=(0,n.useState)(0),[_,q]=(0,n.useState)(new Map),[N,P]=(0,n.useState)(0),[z,M]=(0,n.useState)("unanswered"),[S,C]=(0,n.useState)(null),[A,I]=(0,n.useState)(15);(0,n.useMemo)(()=>o.find(e=>e.id===y.get("mode"))||o[0],[o,y]);let E=(0,n.useMemo)(()=>x([...t]),[t]),R=(0,n.useMemo)(()=>E[k],[E,k]),Q=(0,n.useMemo)(()=>R?x([...R.options]):[],[R]),D=(0,n.useCallback)(async e=>{if(!b||g)return;j(!0);let t=0;e.forEach((e,r)=>{let s=E.find(e=>e.id===r),n=s?.options.find(e=>e.is_correct);n&&e===n.id&&t++});let r=Math.round((Date.now()-N)/1e3),s=Array.from(e.entries()).map(([e,t])=>({quiz_attempt_id:b,question_id:e,selected_option_id:t,is_correct:t===E.find(t=>t.id===e)?.options.find(e=>e.is_correct)?.id}));try{s.length>0&&await a.N.from("user_answers").insert(s),await a.N.from("quiz_attempts").update({score:t,status:"completed",completed_at:new Date().toISOString(),time_taken_seconds:r}).eq("id",b),l.push(`/quiz/results/${b}`)}catch(e){console.error("Error finishing quiz:",e),j(!1)}},[b,g,E,N,l]),G=(0,n.useCallback)(()=>{"answered"===z&&(k<E.length-1?(v(e=>e+1),M("unanswered"),C(null),I(15)):D(_))},[k,E.length,D,_,z]),$=(0,n.useCallback)(e=>{if("answered"===z||!R)return;M("answered"),C(e.id);let t=new Map(_);t.set(R.id,e.id),q(t)},[z,R,_]);if((0,n.useCallback)(e=>{if("answered"===z){("Enter"===e.key||" "===e.key)&&G();return}let t=parseInt(e.key);t>=1&&t<=Q.length&&$(Q[t-1])},[z,Q,$,G]),!b||!R)return(0,s.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-center p-4 bg-slate-900 text-white",children:[(0,s.jsx)(u.A,{className:"h-12 w-12 animate-spin text-cyan-400 mb-4"}),(0,s.jsx)("p",{className:"text-xl text-slate-300",children:"Preparing your quiz..."})]});let L=R.options.find(e=>e.is_correct).id;return(0,s.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center p-4 sm:p-6 bg-slate-900 text-white overflow-hidden",children:(0,s.jsx)("div",{className:"w-full max-w-2xl",children:(0,s.jsx)(p.N,{mode:"wait",children:(0,s.jsxs)(d.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.4,ease:"easeInOut"},className:"bg-slate-800/50 p-6 sm:p-8 rounded-2xl shadow-2xl border border-slate-700/60 w-full",children:[(0,s.jsxs)("header",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-lg font-bold text-cyan-400",children:e.name_en}),(0,s.jsxs)("p",{className:"text-sm text-slate-400",children:["Question ",k+1," of ",E.length]})]}),(0,s.jsx)(m,{timeLeft:A,totalTime:15})]}),(0,s.jsx)(h,{current:k,total:E.length})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold mb-6 text-slate-100 min-h-[6rem] flex items-center",children:R.question_text_en}),(0,s.jsx)("ul",{className:"space-y-3 mb-6",children:Q.map((e,t)=>{let r="default";return"answered"===z&&(e.id===L?r="correct":e.id===S&&(r="incorrect")),(0,s.jsx)(f,{option:e,state:r,onClick:()=>$(e),index:t},e.id)})})]}),(0,s.jsxs)("footer",{className:"flex justify-between items-center text-right h-14 mt-8 pt-4 border-t border-slate-700/50",children:[(0,s.jsxs)("button",{onClick:()=>l.push("/"),className:"text-slate-400 hover:text-slate-200 transition-colors text-sm flex items-center gap-2",children:[(0,s.jsx)(c.A,{size:16})," Quit"]}),"answered"===z&&(0,s.jsx)(d.P.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:G,disabled:g,className:"bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-3 px-8 rounded-lg disabled:bg-slate-600 disabled:cursor-not-allowed flex items-center gap-2",children:g?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.A,{className:"animate-spin h-5 w-5"})," Saving..."]}):k<E.length-1?"Next Question":"Finish Quiz"})]})]},R.id)})})})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},41800:(e,t,r)=>{Promise.resolve().then(r.bind(r,18880))},49391:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(84667).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},77816:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(84667).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},78248:(e,t,r)=>{Promise.resolve().then(r.bind(r,11086))},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[50,199,253,154,296,208,464],()=>r(8782));module.exports=s})();